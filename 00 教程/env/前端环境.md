

# 相关安装

- 首先去 nodejs 官网安装最新的 nodejs 和 npm
- 镜像地址：旧镜像地址 `http://registry.npm.taobao.org` 将于 2022 年 5 月停止，新地址为 `https://registry.npmmirror.com`
- 换源与恢复：使用 `npm config set registry https://registry.npmmirror.com` 更换 npm 镜像源，可使用 `npm get registry` 查看是否更换成功；但换源后会影响模块发布，如果需要发布模块需要换回官方源 `npm config set registry https://registry.npmjs.org`
- 若不想换源，可以安装 cpmn 工具，然后使用 cnpm 替代 npm
- 安装 yarn 和 tyarn：`npm i yarn tyarn -g`，其中 tyarn 类似 cnpm，是对 yarn 的封装，换成了淘宝源
- 也可以不用 tyarn，直接对 yarn 换源：和 npm 类似，使用 `yarn config get registry` 查看当前源，使用 `yarn config set registry https://registry.npmmirror.com` 切换源，原有的官方源为 `https://registry.yarnpkg.com`
- 此外，还可以使用 npm 和 yarn 的管理工具，分别为 nrm 和 yrm，它们可以快速切换 npm 和 yarn 的常用源，使用 `nrm/yrm ls` 查看所有源，带 `*` 的为当前在用的源，使用 `nrm/yrm use xxx` 切换到指定源，使用 `nrm/yrm test` 测试当前源的响应速度

# 项目配置

## WebStorm

### 安装脚手架

作为 Java 程序员出身，相比标准前端开发工具 VS Code，个人更加习惯 WebStorm，故此处记录 WebStorm 如何搭建前端开发环境，主要为处理 eslint 和 prettier 的代码格式化问题，我们会使用 vite 作为构建工具，基于 TS 和 React 作为搭建 demo。

执行下列命令，使用 yarn 基于 Vite 提供的命令安装脚手架
```bash
yarn create vite@latest my-vite-app
cd my-vite-app
yarn
yarn dev
```

### 配置 src 为 @

为了方便 IDE 识别 `@` 到 `src`，我们需要做如下的配置：
- 修改 vite.config.js，添加 `@` 相关配置内容，该配置主要在 Vite 构建时生效
```js
export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': '/src'
    }
  }
})
```
- 但为了方便 IDE 能识别 `@` 到指定路径，我们还需要修改 tsconfig.json 文件，主要添加下述内容：
```js
"compilerOptions": {
  "baseUrl": ".",
  "paths": {
    "@/*": [
      "src/*"
    ]
  }
}
```

### eslint 和 prettier

WebSotrm 已经自动安装了 eslint 插件和 Prettier，其中 ESLint需要在 `Language & Frameworks -> JavaScript -> COde Quality Tool -> EsLint` 中启用插件，

已经安装了插件，项目要能够进行校验则需要安装 eslint 和 Prettier 依赖（或者已经全局安装了），执行下列命令安装依赖：
```bash
yarn add --dev eslint eslint-plugin-react eslint-plugin-import prettier
```

依赖安装完毕后，则需要为项目生成配置，可以执行 `npx eslint --init` 为项目生成 eslint 配置，其会生成 `.eslintrc.cjs`，在控制台选择自己喜欢的选项即可，其中默认缩进为 4，个人习惯为 2 修改为 2，本次配置如下：
```js
module.exports = {
  "env": {
    "browser": true,
    "es2021": true
  },
  "extends": [
    "eslint:recommended",
    "plugin:react/recommended",
    "plugin:@typescript-eslint/recommended"
  ],
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    "ecmaFeatures": {
      "jsx": true
    },
    "ecmaVersion": "latest",
    "sourceType": "module"
  },
  "plugins": [
    "react",
    "@typescript-eslint"
  ],
  "rules": {
    "indent": [
      "error",
      2
    ],
    "linebreak-style": [
      "error",
      "unix"
    ],
    "quotes": [
      "error",
      "double"
    ],
    "semi": [
      "error",
      "always"
    ],
    // suppress errors for missing 'import React' in files
    "react/react-in-jsx-scope": "off",
  }
};
```

对于 Prettier，则需要手动创建 `.prettierrc.js` 作为配置文件，文件用 module.exports = 输出，全部可选配置的详细解释可以看这里 https://prettier.io/docs/en/options.html
```js
module.exports = {
  arrowParens: 'always',
  bracketSameLine: true,
  bracketSpacing: true,
  embeddedLanguageFormatting: 'auto',
  htmlWhitespaceSensitivity: 'css',
  insertPragma: false,
  jsxSingleQuote: false,
  printWidth: 80,
  proseWrap: 'preserve',
  quoteProps: 'as-needed',
  requirePragma: false,
  semi: false,
  singleQuote: true,
  tabWidth: 2,
  trailingComma: 'es5',
  useTabs: false,
  vueIndentScriptAndStyle: false,
}
```

最后，我们配置保存时自动格式化，打开 `Settings -> Tools -> Actions on Save`，勾选上 ESLint 插件和 Prettier 插件，这样只要按下 Ctrl + S 就会自动校验代码并格式化代码了


# 参考连接

- [使用 VS Code 搭建一个很爽的前端环境, by Thomas Yang](https://medium.com/@thoamsy/%E4%BD%BF%E7%94%A8-vs-code-%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%BE%88%E7%88%BD%E7%9A%84%E5%89%8D%E7%AB%AF%E7%8E%AF%E5%A2%83-2d393ba5cc45)
- [用 eslint 和 prettier 让跨 IDE 协作更舒服](https://ssshooter.com/2021-11-05-eslint-and-prettier2/)
- [使用 Vite 搭建 React 项目, by OlyLis](https://juejin.cn/post/7088243962967752711)