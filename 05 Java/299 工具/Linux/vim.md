
# 1. 环境配置

- /etc/vim/vimrc，修改该文件会对所有用户生效，一般不建议更改/etc/vimrc这个文件，因为此文件更改对所有用户生效，故一般只更改当前用户 即更改文件 vim ~/.vimrc (.表示隐藏文件)
- 该文件中的注释以 " 开头，从 " 开始到行末都是注释内容
- 配置内容：
```conf
set nu  "显示行号（set nonu为不显示行号）
set tabstop=4  "设置tab键宽度
set softtabstop=4
set shiftwidth=4
set expandtab
%retab!
set cursorline  "突出显示当前行
set nobackup  "取消自动备份
set bg=dark  "设置背景色为暗色
colorscheme desert  "配色方案
syntax on  "开启语法高亮
set backspace=2  "允许退格键删除
set showmode  "显示左下角状态行(当前状态模式)
set ruler  "显示右下角状态行（行列信息）
set mouse=a  "允许鼠标移动光标
set hlsearch  " 高亮显示搜索结果
set nowrap  " 禁止折行
" set autoindent  "排版自动缩进
```
- colorscheme 高亮方案名可用于设置高亮方案 molokai wombat solarized blackboard desert
- 配色环境文件在 /usr/share/vim/vim73/colors 下 具体可能有细微的变化,和 vim 版本有关，比如我用 ubuntu 为74
- 若需要自动补全，可设置下述内容：
```conf
"设置括号自动补全
inoremap ( ()<ESC>i
inoremap [ []<ESC>i
inoremap { {}<ESC>i
inoremap " ""<ESC>i
inoremap ' ''<ESC>i
```

# 2. 模式切换

- 包含三种模式：命令模式、编辑模式和尾行模式，默认处于命令模式（说法各异）
    - 命令模式 : 默认的模式，可以输入各种编辑命令进行快速操作，如上下左右移动光标、删除字符、删除整行、复制、粘贴等
    - 编辑模式 : 就是普通的编辑
    - 尾行模式 : 一般进行文件的搜索、查找等
- 命令模式下，使用 i, a, o 等字母以不同的状态进入编辑模式
    - `i` 在光标所在位置之前插入字符
    - `a` 在光标所谓位置之后插入字符
    - `o` 当前行的下一行插入字符
    - `O` 当前行的上一行插入字符
    - `I` 在文件首插入
    - `A` 在文件尾插入
- 编辑模式下按 `Esc` 键退回命令模式
- 命令模式下，使用 `:` 或 `/` 或 `?` 进入尾行模式，其中 `/` 和 `?` 可直接进行向上和向下快速查找， `:` 这可输入一些命令，多用于保存、替换大量字符、退出、临时设置等
- 尾行模式下按 `Esc` 退回命令模式


# 3. 常用的编辑快捷键

- `u` 撤销
- `ctrl + u` 反撤销
- `.` 或 `ctrl+r` 重复执行上次操作
- `>>` 当前行缩进
- `<<` 当前行反缩进
- `ZZ` 若文件没有更动，则不保存离开，若已经更动，保存后退出，此时相当于`:wq`

# 4. 编辑相关

## 4.1 跳转

- `h,j,k,l` 分别表示左，下，上，右，可以配合数字使用，如 `3j` 向下移动 3 行
- `+` 跳转到下一行的第一个非空格符号，在代码环境下很常用
- `-` 跳转到上一行的第一个非空格符号
- `0或home` 行首
- `$或End` 行尾
- `nG` 跳转到第n行，如`20G`跳转至第20行 (也可以使用尾行的 `:20` 达到同样效果)
- `20+空格键` 光标往后移动20个字符
- `gg` 跳转到文件首，等于 `1G`
- `G` 跳转到文件尾
- `nG` 跳转到文件的第 n 行
- `{` 跳转到当前代码块首部
- `}` 跳转到当前代码块尾部
- `w` 跳转到下一个单词
- `b` 跳转到上一个单词
- `M` 跳转到当前屏幕区域的中间行
- `H` 跳转到当前屏幕区域的首行
- `L` 跳转到当前屏幕区域的尾行
- `ctrl + f` 向下翻一页
- `ctrl + b` 向上翻一页
- `ctrl + d` 向下翻半页
- `ctrl + u` 向上翻半页
- `n+空格` 往后移动 n 个字符，例如 `20<space>` 往后移动 20 个字符，字符不够会换行，而 `20l` 则不会换行
- `.3n[enter]` 光标往下移动 3 行，等价于 `3j`

## 4.2 复制

- `yy` 复制当前行
- `nyy` 复制当前行往下的n行，如`2yy`复制两行
- `y1G` 复制光标所在行到第一行的所有数据
- `yG` 复制光标所在行到最后一行的所有数据
- `y0` 复制光标所在处到行首的字符
- `y$` 复制光标所在处到行尾的所有字符
- `p` 粘贴在下一行
- `P` 粘贴在上一行

## 4.3 剪切（删除）

**字符**

- `x` 删除当前字符
- `X` 删除当前字符的前一个字符
- `20x` 连续向后删除 20 个字符
- `d0` 删除光标所在处到该行的第一个字符
- `D` 剪切当前位置到行尾的所有字符，和 `d$` 等价


**单词**

- `dw` 剪切当前单词

**行**

- `dd` 剪切当前行，可用`p`粘贴，其他剪切同理
- `20dd` 删除包括当前行往后的 20 行
- `d20+回车` 删除当前行以及之后的 20 行（共删了 21 行，好像不如前面的常用，直接d+回车会删除两行）
- `d1G` 删除光标所在处到第一行的所有数据
- `dG` 删除光标所在处到最后一行的所有数据

## 4.4 选择

- `v` 进入选择模式，使用上下左右进行选择
- `V` 和`v`大致相同，区别就是该命令会选择光标经过的行的一整行
- `ctrl + v` 进入快选择模式

## 4.5 其他

- `r` 替换当前位置的字符
- `R` 从当前位置开始往后连续替换字符
- `J` 将光标所在行和下一行合为一行

# 5. 其他补充

## 5.1 缩进

- `>` 选择的行往右缩进，可以配合`.`命令使用
- `<` 选择的行往左缩进，可以配合`.`命令使用
- y 复制选择区域，d 删除选择区域

## 5.2 尾行与查找

- `:` 进入尾行模式，一般使用`wq`进行保存并退出，
- `:w` 只保存不退出，另 `:w!` 可在文件只读时强行保存，但要求具有权限
- `:q` 退出，若为保存需要先保存，可使用 `:q!` 强制退出不保存
- `/` 进入查找
- `/hello` 查找所有包含hello的位置，并会高亮显示
- 要去掉高亮，可以查找一个不存在的字符串
- `n` 跳转到下一个搜索结果
- `N` 跳转到上一个搜索结果
- `:%s/hello/world` 将所有的hello替换为world
- `:11,16s/hello/world/g` 将11-16行的hello替换为world，可用于函数变量的重命名

命令 | 功能
---|---
/word | 向下查找字符串word
?word | 向上查找字符串word
n | 重复前一次查找操作
N | 反向重复前一次的查找操作
n1,n2s/word1/word2/g | 查找n1-n2行之间的word1并替换为word2
1,$s/word1/word2/g | 第一行到最后一行查找word1并替换为word2
1,$s/word1/word2/gc |  第一行到最后一行查找word1并替换为word2，替换时进行确认

- `:w[filename]` 另存为，filename 为文件名
- `:r[filename]` 在编辑的数据中读入另一个文件的数据，即将"filename"这个文件内容加到光标所在行的后面
- `:n1, n2 w[filename]` n1-n2行的内容保存成filename
- :!command　　暂时离开vi到命令行下执行command的显示结果
    - 如 :!ls /home
    - :set nu　　显示行号
    - :set nonu　　取消行号

## 5.3 打开文件时设置光标

- vim abc　　//编辑或打开文件abc,根据系统不同，有的光标默认在第一行，有的默认在上次退出时停留的行
- vim + abc　　//打开文件之后，将光标定位到最后一行
- vim +3 abs　　//打开后光标停留在文件的第3行
- 若行号超过文件的最大行号，仍然定位到最后一行
- //用于编译报错时的改错是十分方便的
- vim +/word abs　　//直接定位到word第一次出现的那一行

## 5.4 多文件

- vim aa bb cc　　//一次性创建或打开多个文件
- 通过输入 :n 跳转到下一个文件
- 输入 :N 或 :prev 跳转到上一个文件
- :files　　列出目前这个vim打开的所有文件
- `:w[filename]`　　另存为
- `:r[filename]`　　在编辑的数据中读入另一个文件的数据，即将"filename"这个文件内容加到光标所在行的后面
- `:n1, n2 w[filename]` n1-n2 行的内容保存成 filename
- `:!command`　　暂时离开vi到命令行下执行command的显示结果
    - 如 `:!ls /home`


## 5.5 其他

- alias 查看vi是否已经绑定到vim