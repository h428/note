
# 1.1 让LaTex跑起来

可以选择Ctex套装或TexLive，建议选择后者

编辑器可选择TeXStudio、Atom或VS Code

# 1.2 从例子说起

## 基础介绍

- 以gougu.tex为例介绍最基础的Latex相关内容
- %是行注释
- `\documentclass[UTF8]{ctexart}`，其中ctexart是文档类，并用[UTF8]选项指定编码
- `\title{这里填写标题}`用于声明文章的标题
- `\author{这里填写作者}`用于声明文章的作者
- `\date{\today}`用于声明文章的写作日期为今天
- 但这些信息不会直接出现在文章中，需要在document内部使用指令`\maketitle`才能生成相关信息
- `\bibliographystyle{格式}`声明参考文献的格式
- 在`\begin{document}`之前的部分称为导言区，导言区通常用于对文档的性质做一些设置，或定义一些命令
- `\begin{document}`和`\end{document}`声明了一个document环境，其内部是正文部分，也就是直接输出的部分
- `\maketitle`命令用于输出标题
- `tableofcontents`命令输出目录
- `\section{标题内容}`用于开始新的一节（大标题）
- `\bibliography{math}`则是告诉tex从文献数据库math中获取文献信息，打印参考文献列表
- Latex中，要使用空行分段，多个空行和一个空行的效果一致
- 在进行中英文混排时，LaTex会自动在中英文之间加上一个空格
- 英文之间的多个空格会被处理为只留下一个空格，而中文之间的空格会被直接忽略
- 没有空行的换行会被处理为一个空格，因此，英文文本的换行会被处理为一个空格，而中文文本之间的换行会被直接忽略
- 段首不需缩进或者输入空格，事实上Latex会忽略段首的所有缩进和空格，并自动在结果中做缩进
- 可以利用上述特性排版源码，增强源码的可读性
- 使用xelatex编译文档时，ctexart文档类会调用xeCJK宏包，自动处理汉字和其他符号之间的距离，这十分方便
- 使用`--`可以产生一个与字母n等宽的横线，可用于表示某年到某年这种场景

## 命令与环境(重要)

**命令**

- 如`\footnote{脚注内容}`就是一个命令，后面的花括号表示命令的参数
- Latex的命令格式为：`\command[可选参数]{参数1}{参数2}...{参数n}`
- `\footnote{脚注内容}`就是带有一个参数的命令，而`\documentclass[UTF8]{ctexart}`就是一个带有可选参数的命令


**环境**

- 如`\begin{quote}引用内容\end{quote}`定义引用环境，内部为引用内容；类似的，`\begin{abstract}摘要内容\end{abstract}`定义摘要环境，内部编写摘要内容
- 环境的格式为：`\begin{环境名}[可选参数]{其他参数...} 环境内容 \end{环境名}`
- 例如，定理环境可以有一个可选参数，用于描述定理的名字`\begin{thm}[勾股定理] ... \end{thm}`

## 数学公式

- 公式可分为行内公式和列表公式，行内公式在正文中使用，而相对比较长或比较重要的公式，往往单独居中写在一行，这成为列表公式
- 使用一对符号`$公式内容$`定义行内公式，如`$\pi$`
- 使用符号`$$公式内容$$`或equation环境定义列表公式，如勾股定理描述为：`$$a^2 + b^2 = c^2$$`，注意双$产生的公式不会自动进行编号，而equation环境产生的公式会自动进行编号
- 此外，还有一个支持多行以及对其的公式输入环境align
- 几何中的角符号∠可以使用`\angle`表示
- 符号`^{上标内容}`引入一个上标，而符号`_{下标内容}`则引入一个下标，若上下标只有一个字符，可以省略花括号
- 几何中的角度符号°可以利用上标符号配合函数复合运算符完成：`^\circ`

## 使用图标

- LaTex中使用插图有两种：一是事先准备带插入的图片，二是直接使用LaTex代码画图，大多数情况使用第一种
- 插图功能由 **graphicx** 宏包提供，因此要使用插图功能，需要在导言区声明：`\usepackage{graphicx}`
- 引入 graphicx 宏包后，就可以使用 `\includegraphics` 命令进行插图了
- `\includegraphics[scale=0.6]{xiantu.pdf}`：可选参数scale表示对图片进行等比例缩放，必选参数为插图的路径，该命令还有其他可选参数，如宽度width，高度height等

## 浮动体与混排（重要）

- 进行图文或表文混排时，我们很少把插图直接夹杂在文字之间，而采用单独的环境列出
- 以图为例，如果图片很大或固定位置，会给分页造成困难，因此通常把图放在一个可以变动想对位置的环境中，成为浮动体
- 在浮动体中还可以加入说明性的标题
- **figure** 环境，即为插图的浮动体环境，该环境有可选参数[ht]，分别表示浮动体可以出现在周围文本的所在处和下一页的顶部，且优先使用h，h放置不下才会采用t，并且与生命顺序无关，[ht]和[th]拥有相同的表现结果
- 在figure环境中，还可以使用`\centering`进行图片居中，使用`\caption{图片名称}`为图片命名（若没有处理过格式，该指令会自动生成编号），使用`\label{引用标志}`定义引用标志，在文中可使用`\ref{引用标志}`进行引用，LaTex会自动处理编号问题
- 样例代码如下：
```latex
\begin{figure}[ht]
	\centering % 图片居中
	\includegraphics[scale=0.9]{t.jpg} % 缩放
	\caption{孙悟空} % 图片名称
	\label{img:sun} % 定义label，在正文中可以用\ref{img:sun} 引用，可实现自动编号
\end{figure}
```

## 表格与浮动

- 一般直接在LaTex中完成表格的绘制
- 使用 **tabular** 环境绘制表格，该环境有一个参数，其声明了表格中列的模式(有多少列，是否绘制竖线)
- 在 tabular 内部，使用`\hline`绘制表格横线
- 每行使用符号 `&` 划分单元格，并使用符号 `\\` 表示本行结束
- 表格也是比较大的内容，因此也需要一个浮动体， **table** 环境即为表格的浮动体，其参数大致和 figure 差不多，表现也差不多，只是`\caption{表名称}`得到的是表而不是图
- 注意下面的可选参数[H]表示就放在这儿，不浮动，他并不是LaTex的标准浮动体参数，而是由 **float** 宏包提供的特殊困难
- 强烈不建议采用[H]参数，因为若图片（或表格）恰好处于页尾且由于图片过大，必定自动移动到下一页的页首，此时若使用了该参数，则会导致文字不自动移动到当前页尾而使页尾留下空白，影响排版
- H参数一般用于表格很小（不影响分页功能），且行文要求连贯的场合，此时这个参数就能派上用场
- 样例代码如下：
```latex
\begin{table}[H] % 不建议采用H参数，而应采用ht
	\centering % 表格居中
	\caption{勾股数} % 表格标题，会自动编号
	\begin{tabular}{ccc} % 定义列模式
		\hline % 绘制三线表的第一条横线
		直角边 $a$ & 直角边 $b$ & 斜边 $c$ \\ % 每行的数据用 & 分隔
		\hline % 三线表的第二条横线
		3 & 4 & 5\\ % \\表示结束当前行
		5 & 12 & 13\\
		\hline % 三线表的第三条横线
	\end{tabular}
\end{table}
```

## 多内容浮动体

- 不管是图片还是表格，一个浮动体可以包含多个内容，这样可以实现图片、表格的并排和双排双列等结构
- 行列之间的间距可以使用`\hspace{5pt}`和`\vspace{5pt}`之类的指令进行控制
- 双排双列图片代码样例：
```latex
\begin{figure}[ht]
	\centering % 图片居中
	\caption{孙悟空} % 图片名称
	\label{img:sun} % 定义label，在正文中可以用\ref{img:sun} 引用，可实现自动编号
	
	\includegraphics[scale=0.9]{t.jpg} \hspace{5pt} % 缩放
	\includegraphics[scale=0.9]{t.jpg} % 缩放
	
	\vspace{10pt}
	
	\includegraphics[scale=0.9]{t.jpg} \hspace{5pt} % 缩放
	\includegraphics[scale=0.9]{t.jpg} % 缩放
\end{figure}
```
- 双排双列表格样例：
```latex
\begin{table}[ht] % 不建议采用H参数，而应采用ht
	\centering % 表格居中
	
	\begin{tabular}{ccc} % 定义列模式
		\hline % 绘制三线表的第一条横线
		直角边 $a$ & 直角边 $b$ & 斜边 $c$ \\ % 每行的数据用 & 分隔
		\hline % 三线表的第二条横线
		3 & 4 & 5\\ % \\表示结束当前行
		5 & 12 & 13\\
		\hline % 三线表的第三条横线
	\end{tabular}
	\hspace{8pt}
	\begin{tabular}{ccc} % 定义列模式
		\hline % 绘制三线表的第一条横线
		直角边 $a$ & 直角边 $b$ & 斜边 $c$ \\ % 每行的数据用 & 分隔
		\hline % 三线表的第二条横线
		3 & 4 & 5\\ % \\表示结束当前行
		5 & 12 & 13\\
		\hline % 三线表的第三条横线
	\end{tabular}

	\vspace{8pt}

	\begin{tabular}{ccc} % 定义列模式
		\hline % 绘制三线表的第一条横线
		直角边 $a$ & 直角边 $b$ & 斜边 $c$ \\ % 每行的数据用 & 分隔
		\hline % 三线表的第二条横线
		3 & 4 & 5\\ % \\表示结束当前行
		5 & 12 & 13\\
		\hline % 三线表的第三条横线
	\end{tabular}
	\hspace{8pt}
	\begin{tabular}{ccc} % 定义列模式
		\hline % 绘制三线表的第一条横线
		直角边 $a$ & 直角边 $b$ & 斜边 $c$ \\ % 每行的数据用 & 分隔
		\hline % 三线表的第二条横线
		3 & 4 & 5\\ % \\表示结束当前行
		5 & 12 & 13\\
		\hline % 三线表的第三条横线
	\end{tabular}
\end{table}
```

## 自动化工具与交叉引用

$a^2 + b^2 = c^2$

- 前面已经提到：使用`\bibliographystyle{风格内容}`声明参考文献的格式，使用`\bibliography{文献数据库}`声明引用具体数据库并列出引用
- 文件数据库 math.bib 文件的内容可以参考笔记 `/09 工具/LaTex/gougu.tex.md`
- 一般来说，文献数据库的内容包括：类型、引用标签、标题、作者、出版年、出版社等信息
- 可以使用文献管理工具 **JabRef** 管理和制作文件数据库
- 一般来说，一个tex源文件只需要用`pdflatex`或`xelatex`编译一次，但若存在交叉引用（`\ref`），则需要编译两次，则需要编译两次
	1. 第一次编译，确定交叉引用的地方，并确定该处的编号并生成LaTex代码（此时生成的pdf内容不具有编号，是形如 **图??** 这种格式），编译代码为：`xelatex.exe -synctex=1 -interaction=nonstopmode gougu.tex`
	2. 第二次编译，填入自动生成的编号，并生成最终结果，编译代码为：`xelatex.exe -synctex=1 -interaction=nonstopmode gougu.tex`
- 若是源文件还有参考文献及数据库，则需要编译四次：
	1. 执行`xelatex`扫描源文件`gougu.tex`，确定数据库中的哪些参考文献需要被列出来，为`bibtex`准备好辅助文件
	2. 用`bibtex`处理辅助文件`gougu.aux`，从文献数据库选取文献，按指定格式生成文献列表的LaTex代码
	3. 后两次`xelatex`即为交叉引用处理，读入文献列表代码，并自动生成引用信息
- 使用`\cite{文献数据库中的参考文献ID}`引用文献，并会自动生成编号（注意要在第三次xelatex编译后才能确定编号）
- bibtex 是最复杂的自动化工具，最简单的是页码、定理和公式的自动编号，此外还有生成目录与图表公式的交叉引用
- 引用不仅限与参考文献，还可以是图、表、公式的编号，只要实现设定了标签`\label{标签}`，就可以使用`\ref{标签}`进行交叉引用，LaTex会自动处理相关编号问题
- 公式编号的引用也可以用这个方法处理，但需要先在公式环境中定义标签：
```
\begin{equation}
	\label{eq:gougu}
	AB^2 = BC^2 + AC^2
\end{equation}
```
- 在正文中使用`\ref{eq:gougu}`进行引用（可以引用公式、图表等），此外，数学宏包 **amsmath** 定义了 \eqref 命令，专门用于公式的引用：`\eqref{eq:gougu}`，注意 `\eqref` 会自动产生括号而 `\ref` 不会
- 注意，在浮动体中，`\caption`要放在`\label`前面，否则可能产生问题

## 设计文章格式

- 绝大多数设计是通过在导演区通过一些命令定义和参数化设定来完成，但往往相当复杂
- 但许多工作都可以使用一些宏包来简化，如前面已经使用的 **graphicx**、**float**、**amsmath**
- 下载再介绍几种常用宏包：

**设计页面尺寸**

- 设计页面尺寸可以使用 **geometry** 宏包：
```
\usepackage{geometry} % 引入页面设计宏包
\geometry{a6paper, centering, scale=0.8} % 使用宏包中的命令控制页面大小
```

**改变图表标题格式**

- 改变图表标题格式可以使用 **caption** 宏包
```
\usepackage[format=center,font=small,textfont=it]{caption}
```
- 上述代码设置标题使用悬挂式对其（编号向左突出），整体使用小字号，标题文本使用斜体（对汉字来说就是楷书


**增加目录项目**

- 默认情况下，`\tableofcontents`生成的目录不包含目录项和参考文献项
- **tocbibind** 宏包可用于在目录中增加目录项、参考文献项
- 此外，可以使用该宏包的可选参数 nottoc 取消在目录中生成目录项

## 定义新环境

- 当需要在某个环境的基础上做一些额外的格式设置，或者需要为这个环境定义统一的格式，可以使用定义新环境功能
- 使用`\newenvironment`定义新环境，其语法为：`\newenvironment{新环境名}{环境首控制格式}{环境尾}`
- 例如，自定义的引用环境为：
```
\newenvironment{myquote} % 新环境名
  {\begin{quote}\kaishu\zihao{-5}} % 环境首以及格式控制，\begin{myquote}会被替换成这行内容
  {\end{quote}} % 环境尾 \end{myquote}会被替换成这行内容
```

## 定义新命令

- 类似环境，有时我们可能需要定义新的命令，例如数学中的角度
- 使用`\newcommand\新命令名{新命令具体内容}`定义一个新命令
- 例如，度可以这样定义：`\newcommand\degree{^\circ}`，之后在文中便可以用`\degree`命令表示度





